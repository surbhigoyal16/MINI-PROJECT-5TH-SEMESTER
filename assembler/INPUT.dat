COPY Start 1000
first Stl retad
cloop Jsub rdrec
- Lda lengt
- Comp zero
- Jeq endfl
- Jsub wrec
- j cloop
endfl Lda eof
- Sta bufer
- Lda three
- Sta lengt
- Jsub wrec
- Ldl retad
- Rsub -
eof Byte C,EOF,
three Word 3
zero Word 0
retad Resw 1
lengt Resw 1
bufer Resb 4096
rdrec Ldx zero
- Lda zero
rloop Td input
- Jeq rloop
- Rd input
- Comp zero
- Jeq exit
- Stch bufer,x
- Tix maxln
- Jlt rloop
exit Stx lengt
- Rsub -
input Byte X,F1,
maxln Word 4096
wrec Ldx zero
wloop Td out
- Jeq wloop
- Ldch bufer,x
- Wd out
- Tix lengt
- Jlt wloop
- Rsub -
out Byte X,05,
- End first